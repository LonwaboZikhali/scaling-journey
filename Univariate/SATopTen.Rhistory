library(readxl)
library(dplyr)
library(ggplot2)
library(scales)
CODAfrica <- read_excel("Cause of Death AFRICA.xlsx")
top10 <- CODAfrica %>% filter(Entity == "South Africa", Year == 2006) %>% select(-Entity, -Code, -Year) %>% pivot_longer(cols = everything(), names_to = "Cause", values_to = "Fatalities") %>% arrange(desc(Fatalities)) %>% slice(1:10) %>% mutate(Color = ifelse(Cause == "HIV/AIDS fatalities", "red", "grey"))
ggplot(top10, aes(x = reorder(Cause, Fatalities), y = Fatalities, fill = Color)) + geom_bar(stat = "identity", color = "black", width = 0.7) + scale_fill_identity() + coord_flip() + labs(title = "Top 10 Causes of Death in South Africa (2006)", x = "", y = "Number of Fatalities") + theme_minimal() + theme(axis.text.y = element_text(size = 14)) + scale_y_continuous(labels = label_comma())
ggsave("SouthAfricanTopTen.png", dpi = 300)
savehistory("SATopTen")